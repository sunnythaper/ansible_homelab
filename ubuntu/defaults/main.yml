---
# FAIL2BAN
fail2ban_backend: "auto"
fail2ban_bantime: "10m"
fail2ban_destemail: "{{ admin_email }}"
fail2ban_findtime: "10m"
fail2ban_logencoding: "auto"
fail2ban_maxretry: "5"
fail2ban_mta: "sendmail"
fail2ban_protocol: "tcp"
fail2ban_sender: "fail2ban.{{ network_hostname }}@{{ network_domain }}"
fail2ban_usedns: "warn"

# LOCALIZATION
localization_timezone: America/Phoenix

# LOGIN DEFS
login_defs_CHFN_RESTRICT: "rwh"
login_defs_DEFAULT_HOME: "no"
login_defs_ENCRYPT_METHOD: "SHA512"
login_defs_ENV_PATH: "PATH=/usr/local/bin:/usr/bin:/bin"
login_defs_ENV_SUPATH: "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
login_defs_ERASECHAR: "0177"
login_defs_FAILLOG_ENAB: "yes"
login_defs_FTMP_FILE: "/var/log/btmp"
login_defs_GID_MAX: "60000"
login_defs_GID_MIN: "1000"
login_defs_HUSHLOGIN_FILE: ".hushlogin"
login_defs_KILLCHAR: "025"
login_defs_LOG_OK_LOGINS: "no"
login_defs_LOG_UNKFAIL_ENAB: "no"
login_defs_LOGIN_RETRIES: "5"
login_defs_LOGIN_TIMEOUT: "60"
login_defs_MAIL_DIR: "/var/mail"
login_defs_PASS_MAX_DAYS: "99999"
login_defs_PASS_MIN_DAYS: "0"
login_defs_PASS_WARN_AGE: "7"
login_defs_SHA_CRYPT_MAX_ROUNDS: "65536"
login_defs_SHA_CRYPT_MIN_ROUNDS: "10000"
login_defs_SU_NAME: "su"
login_defs_SYSLOG_SG_ENAB: "yes"
login_defs_SYSLOG_SU_ENAB: "yes"
login_defs_TTYGROUP: "tty"
login_defs_TTYPERM: "0600"
login_defs_UID_MAX: "60000"
login_defs_UID_MIN: "1000"
login_defs_UMASK: "077"
login_defs_USERGROUPS_ENAB: "no"

# NETWORK
network_disable_dccp: true
network_disable_sctp: true
network_disable_rds: true
network_disable_tipc: true
network_domain: mydomain.com
network_fqdn: "{{ network_hostname }}.{{ network_domain }}"
network_hostname: "{{ inventory_hostname }}"
network_ip: "{{ ansible_host }}"
network_nameservers:
  - "1.1.1.1"
  - "1.0.0.1"

# PACKAGES
packages_blocklist:
  - apport*
  - autofs
  - avahi-*
  - avahi*
  - beep
  - bind9
  - cups
  - dovecot-imapd
  - dovecot-pop3d
  - isc-dhcp-server
  - ldap-utils
  - nis
  - openbsd-inetd
  - pastebinit
  - popularity-contest
  - rpcbind
  - rsh*
  - rsync
  - samba
  - slapd
  - snmpd
  - squid
  - talk*
  - telnet*
  - tftp*
  - vsftpd
  - whoopsie
  - xinetd
  - xserver-xorg*
  - yp-tools
  - ypbind
  - iptables-persistent

packages_preferred:
  - acl
  - apt-show-versions
  - aptitude
  - debsums
  - fail2ban
  - iptables
  - sudo
  - ufw

# POSTFIX
postfix_disable_vrfy_command: "yes"
postfix_inet_interfaces: "loopback-only"
postfix_smtp_tls_loglevel: "1"
postfix_smtpd_banner: "$myhostname ESMTP"
postfix_smtpd_client_restrictions: "permit_mynetworks,reject"
postfix_smtpd_helo_required: "yes"

# UNATTENDED UPGRADES
unattended_upgrade_AutoFixInterruptedDpkg: "true"
unattended_upgrade_Automatic_Reboot_Time: "05:00"
unattended_upgrade_Automatic_Reboot_WithUsers: "false"
unattended_upgrade_Automatic_Reboot: "true"
unattended_upgrade_Debug: "false"
unattended_upgrade_InstallOnShutdown: "false"
unattended_upgrade_Mail: "{{ admin_email }}"
unattended_upgrade_MailOnlyOnError: true
unattended_upgrade_MinimalSteps: "true"
unattended_upgrade_OnlyOnACPower: "true"
unattended_upgrade_Package_Blacklist: []
unattended_upgrade_Remove_New_Unused_Dependencies: "true"
unattended_upgrade_Remove_Unused_Dependencies: "true"
unattended_upgrade_Remove_Unused_Kernel_Packages: "true"
unattended_upgrade_Skip_Updates_On_Metered_Connections: "true"
unattended_upgrade_SyslogEnable: "true"
unattended_upgrade_SyslogFacility: "daemon"
unattended_upgrade_Verbose: "false"

# USERS
ansible_admin_user: ansible
admin_email: "admin@mydomain.com"
admin_user: admin
admin_password: password
admin_password_salt: passwordsalt
admin_public_key: publickey
users_blacklist:
  - games
  - gnats
  - irc
  - list
  - news
  - sync
  - uucp

# SSHD
sshd_AcceptEnv: "LANG LC_*"
sshd_AddressFamily: "inet"
sshd_AllowAgentForwarding: "no"
sshd_AllowTcpForwarding: "no"
sshd_AuthorizedKeysCommand: "none"
sshd_AuthorizedKeysCommandUser: "nobody"
sshd_AuthorizedKeysFile: ".ssh/authorized_keys"
sshd_AuthorizedPrincipalsFile: "none"
sshd_Banner: "/etc/issue.net"
sshd_ChallengeResponseAuthentication: "no"
sshd_ChrootDirectory: "none"
sshd_Ciphers: "chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com"
sshd_ClientAliveCountMax: "2"
sshd_ClientAliveInterval: "300"
sshd_Compression: "no"
sshd_config_name: secure
sshd_GatewayPorts: "no"
sshd_GSSAPIAuthentication: "no"
sshd_GSSAPICleanupCredentials: "yes"
sshd_GSSAPIKeyExchange: "no"
sshd_GSSAPIStrictAcceptorCheck: "yes"
sshd_HostbasedAuthentication: "no"
sshd_HostKey: "/etc/ssh/ssh_host_ecdsa_key"
sshd_HostKey2: "/etc/ssh/ssh_host_ed25519_key"
sshd_HostKey3: "/etc/ssh/ssh_host_rsa_key"
sshd_HostKeyAlgorithms: "ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,sk-ssh-ed25519@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-512,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com"
sshd_IgnoreRhosts: "yes"
sshd_IgnoreUserKnownHosts: "yes"
sshd_KerberosAuthentication: "no"
sshd_KerberosGetAFSToken: "no"
sshd_KerberosOrLocalPasswd: "yes"
sshd_KerberosTicketCleanup: "yes"
sshd_KexAlgorithms: "curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256"
sshd_ListenAddress: "0.0.0.0"
sshd_LoginGraceTime: "30s"
sshd_LogLevel: "VERBOSE"
sshd_MACs: "umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com"
sshd_MaxAuthTries: "3"
sshd_MaxSessions: "2"
sshd_MaxStartups: "3"
sshd_PasswordAuthentication: "no"
sshd_PermitEmptyPasswords: "no"
sshd_PermitRootLogin: "no"
sshd_PermitTTY: "yes"
sshd_PermitTunnel: "no"
sshd_PermitUserEnvironment: "no"
sshd_PidFile: "/var/run/sshd.pid"
sshd_Port: "22"
sshd_PrintLastLog: "yes"
sshd_PrintMotd: "no"
sshd_Protocol: "2"
sshd_PubkeyAuthentication: "yes"
sshd_RekeyLimit: "1G 1300"
sshd_StrictModes: "yes"
sshd_Subsystem: "sftp /usr/lib/openssh/sftp-server"
sshd_SyslogFacility: "AUTHPRIV"
sshd_TCPKeepAlive: "no"
sshd_UseDNS: "no"
sshd_UsePAM: "yes"
sshd_UsePrivilegeSeparation: "sandbox"
sshd_VersionAddendum: "none"
sshd_X11DisplayOffset: "10"
sshd_X11Forwarding: "no"
sshd_X11UseLocalhost: "yes"

# SYSCTL
sysctl_dev_tty_ldisc_autoload: 0
sysctl_net_ipv6_conf_accept_ra_rtr_pref: 0
sysctl_settings:
  fs.protected_hardlinks: 1
  fs.protected_symlinks: 1
  fs.suid_dumpable: 0
  kernel.core_uses_pid: 1
  kernel.dmesg_restrict: 1
  kernel.kptr_restrict: 2
  kernel.panic_on_oops: 60
  kernel.panic: 60
  kernel.perf_event_paranoid: 2
  kernel.randomize_va_space: 2
  kernel.sysrq: 0
  kernel.unprivileged_bpf_disabled: 1
  kernel.yama.ptrace_scope: 2
  net.core.bpf_jit_harden: 2
  net.ipv4.conf.all.accept_redirects: 0
  net.ipv4.conf.all.accept_source_route: 0
  net.ipv4.conf.all.arp_announce: 2
  net.ipv4.conf.all.arp_ignore: 1
  net.ipv4.conf.all.bootp_relay: 0
  net.ipv4.conf.all.forwarding: 0
  net.ipv4.conf.all.log_martians: 1
  net.ipv4.conf.all.mc_forwarding: 0
  net.ipv4.conf.all.proxy_arp: 0
  net.ipv4.conf.all.rp_filter: 1
  net.ipv4.conf.all.secure_redirects: 0
  net.ipv4.conf.all.send_redirects: 0
  net.ipv4.conf.all.shared_media: 0
  net.ipv4.conf.default.accept_redirects: 0
  net.ipv4.conf.default.accept_source_route: 0
  net.ipv4.conf.default.log_martians: 1
  net.ipv4.conf.default.rp_filter: 1
  net.ipv4.conf.default.secure_redirects: 0
  net.ipv4.conf.default.send_redirects: 0
  net.ipv4.conf.default.shared_media: 0
  net.ipv4.icmp_echo_ignore_all: 1
  net.ipv4.icmp_echo_ignore_broadcasts: 1
  net.ipv4.icmp_ignore_bogus_error_responses: 1
  net.ipv4.icmp_ratelimit: 100
  net.ipv4.icmp_ratemask: 88089
  net.ipv4.ip_forward: 0
  net.ipv4.tcp_challenge_ack_limit: 2147483647
  net.ipv4.tcp_fin_timeout: 15
  net.ipv4.tcp_invalid_ratelimit: 500
  net.ipv4.tcp_keepalive_time: 1800
  net.ipv4.tcp_max_syn_backlog: 20480
  net.ipv4.tcp_max_tw_buckets: 1440000
  net.ipv4.tcp_rfc1337: 1
  net.ipv4.tcp_sack: 0
  net.ipv4.tcp_syn_retries: 5
  net.ipv4.tcp_synack_retries: 2
  net.ipv4.tcp_syncookies: 1
  net.ipv4.tcp_timestamps: 0
  net.ipv6.conf.all.accept_ra_defrtr: 0
  net.ipv6.conf.all.accept_ra_pinfo: 0
  net.ipv6.conf.all.accept_ra_rtr_pref: 0
  net.ipv6.conf.all.accept_ra: 0
  net.ipv6.conf.all.accept_redirects: 0
  net.ipv6.conf.all.accept_source_route: 0
  net.ipv6.conf.all.autoconf: 0
  net.ipv6.conf.all.dad_transmits: 0
  net.ipv6.conf.all.disable_ipv6: 1
  net.ipv6.conf.all.forwarding: 0
  net.ipv6.conf.all.max_addresses: 1
  net.ipv6.conf.all.router_solicitations: 0
  net.ipv6.conf.all.use_tempaddr: 2
  net.ipv6.conf.default.accept_ra_defrtr: 0
  net.ipv6.conf.default.accept_ra_pinfo: 0
  net.ipv6.conf.default.accept_ra_rtr_pref: 0
  net.ipv6.conf.default.accept_ra: 0
  net.ipv6.conf.default.accept_redirects: 0
  net.ipv6.conf.default.accept_source_route: 0
  net.ipv6.conf.default.autoconf: 0
  net.ipv6.conf.default.dad_transmits: 0
  net.ipv6.conf.default.max_addresses: 1
  net.ipv6.conf.default.router_solicitations: 0
  net.ipv6.conf.default.use_tempaddr: 2
  net.netfilter.nf_conntrack_max: 2000000
  net.netfilter.nf_conntrack_tcp_loose: 0
  vm.swappiness: 10
  vm.vfs_cache_pressure: 150